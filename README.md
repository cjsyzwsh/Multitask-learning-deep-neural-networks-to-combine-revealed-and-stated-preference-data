# Multitask learning to combine RP and SP.
Work done by Shenhao Wang, Qingyi Wang, and Jinhua Zhao

It is an enduring question how to combine revealed preference (RP) and stated preference (SP) data to analyze individual choices. This study presents a framework of multitask learning deep neural networks (MTLDNNs) to jointly analyze RP and SP, demonstrating its theoretical flexibility and empirical benefits in terms of prediction and economic interpretation. Theoretically, the MTLDNN framework is more generic than the classical nested logit (NL) method because of MTLDNNsâ€™ capacity of automatic feature learning and flexible regularization. Empirically, MTLDNNs outperform six benchmark models and particularly the classical NL models by about 5% prediction accuracy in analyzing the adoption of autonomous vehicles (AVs) based on a survey data collected in Singapore. This improvement can be mainly attributed to the soft constraints specific to multitask learning, including its innovative architectural design and regularization methods, but not much to the generic capacity of automatic feature learning endowed by a standard feedforward DNN architecture. Besides prediction, MTLDNNs are also interpretable. MTLDNNs reveal that AVs mainly substitute driving and that the variables specific to AVs are more important than the socio-economic variables in determining AV adoption. Overall, this study presents a new MTLDNN framework in combining RP and SP, demonstrates its theoretical flexibility of architectural design and regularizations, shows its empirical predictive power, and extracts reasonable economic information for interpretation. Future studies can explore other MTLDNN architectures, new choice modeling applications for multitask learning, and deeper theoretical connections between the MTLDNN framework and structural choice modeling.

#### Note: all the codes and the paper are included in this repository. Unfortunately, we cannot upload the data set due to the policy limitation.
